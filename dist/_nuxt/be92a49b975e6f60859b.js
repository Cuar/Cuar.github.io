(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{335:function(t,e,n){"use strict";function o(t){return function(t){if(Array.isArray(t)){for(var i=0,e=new Array(t.length);i<t.length;i++)e[i]=t[i];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.d(e,"a",(function(){return o}))},467:function(t,e,n){var map={"./af":336,"./af.js":336,"./ar":337,"./ar-dz":338,"./ar-dz.js":338,"./ar-kw":339,"./ar-kw.js":339,"./ar-ly":340,"./ar-ly.js":340,"./ar-ma":341,"./ar-ma.js":341,"./ar-sa":342,"./ar-sa.js":342,"./ar-tn":343,"./ar-tn.js":343,"./ar.js":337,"./az":344,"./az.js":344,"./be":345,"./be.js":345,"./bg":346,"./bg.js":346,"./bm":347,"./bm.js":347,"./bn":348,"./bn.js":348,"./bo":349,"./bo.js":349,"./br":350,"./br.js":350,"./bs":351,"./bs.js":351,"./ca":352,"./ca.js":352,"./cs":353,"./cs.js":353,"./cv":354,"./cv.js":354,"./cy":355,"./cy.js":355,"./da":356,"./da.js":356,"./de":357,"./de-at":358,"./de-at.js":358,"./de-ch":359,"./de-ch.js":359,"./de.js":357,"./dv":360,"./dv.js":360,"./el":361,"./el.js":361,"./en-SG":362,"./en-SG.js":362,"./en-au":363,"./en-au.js":363,"./en-ca":364,"./en-ca.js":364,"./en-gb":365,"./en-gb.js":365,"./en-ie":366,"./en-ie.js":366,"./en-il":367,"./en-il.js":367,"./en-nz":368,"./en-nz.js":368,"./eo":369,"./eo.js":369,"./es":370,"./es-do":371,"./es-do.js":371,"./es-us":372,"./es-us.js":372,"./es.js":370,"./et":373,"./et.js":373,"./eu":374,"./eu.js":374,"./fa":375,"./fa.js":375,"./fi":376,"./fi.js":376,"./fo":377,"./fo.js":377,"./fr":378,"./fr-ca":379,"./fr-ca.js":379,"./fr-ch":380,"./fr-ch.js":380,"./fr.js":378,"./fy":381,"./fy.js":381,"./ga":382,"./ga.js":382,"./gd":383,"./gd.js":383,"./gl":384,"./gl.js":384,"./gom-latn":385,"./gom-latn.js":385,"./gu":386,"./gu.js":386,"./he":387,"./he.js":387,"./hi":388,"./hi.js":388,"./hr":389,"./hr.js":389,"./hu":390,"./hu.js":390,"./hy-am":391,"./hy-am.js":391,"./id":392,"./id.js":392,"./is":393,"./is.js":393,"./it":394,"./it-ch":395,"./it-ch.js":395,"./it.js":394,"./ja":396,"./ja.js":396,"./jv":397,"./jv.js":397,"./ka":398,"./ka.js":398,"./kk":399,"./kk.js":399,"./km":400,"./km.js":400,"./kn":401,"./kn.js":401,"./ko":402,"./ko.js":402,"./ku":403,"./ku.js":403,"./ky":404,"./ky.js":404,"./lb":405,"./lb.js":405,"./lo":406,"./lo.js":406,"./lt":407,"./lt.js":407,"./lv":408,"./lv.js":408,"./me":409,"./me.js":409,"./mi":410,"./mi.js":410,"./mk":411,"./mk.js":411,"./ml":412,"./ml.js":412,"./mn":413,"./mn.js":413,"./mr":414,"./mr.js":414,"./ms":415,"./ms-my":416,"./ms-my.js":416,"./ms.js":415,"./mt":417,"./mt.js":417,"./my":418,"./my.js":418,"./nb":419,"./nb.js":419,"./ne":420,"./ne.js":420,"./nl":421,"./nl-be":422,"./nl-be.js":422,"./nl.js":421,"./nn":423,"./nn.js":423,"./pa-in":424,"./pa-in.js":424,"./pl":425,"./pl.js":425,"./pt":426,"./pt-br":427,"./pt-br.js":427,"./pt.js":426,"./ro":428,"./ro.js":428,"./ru":429,"./ru.js":429,"./sd":430,"./sd.js":430,"./se":431,"./se.js":431,"./si":432,"./si.js":432,"./sk":433,"./sk.js":433,"./sl":434,"./sl.js":434,"./sq":435,"./sq.js":435,"./sr":436,"./sr-cyrl":437,"./sr-cyrl.js":437,"./sr.js":436,"./ss":438,"./ss.js":438,"./sv":439,"./sv.js":439,"./sw":440,"./sw.js":440,"./ta":441,"./ta.js":441,"./te":442,"./te.js":442,"./tet":443,"./tet.js":443,"./tg":444,"./tg.js":444,"./th":445,"./th.js":445,"./tl-ph":446,"./tl-ph.js":446,"./tlh":447,"./tlh.js":447,"./tr":448,"./tr.js":448,"./tzl":449,"./tzl.js":449,"./tzm":450,"./tzm-latn":451,"./tzm-latn.js":451,"./tzm.js":450,"./ug-cn":452,"./ug-cn.js":452,"./uk":453,"./uk.js":453,"./ur":454,"./ur.js":454,"./uz":455,"./uz-latn":456,"./uz-latn.js":456,"./uz.js":455,"./vi":457,"./vi.js":457,"./x-pseudo":458,"./x-pseudo.js":458,"./yo":459,"./yo.js":459,"./zh-cn":460,"./zh-cn.js":460,"./zh-hk":461,"./zh-hk.js":461,"./zh-tw":462,"./zh-tw.js":462};function o(t){var e=r(t);return n(e)}function r(t){if(!n.o(map,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return map[t]}o.keys=function(){return Object.keys(map)},o.resolve=r,t.exports=o,o.id=467},492:function(t,e,n){var content=n(572);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(12).default)("529c7040",content,!0,{sourceMap:!1})},493:function(t,e,n){var content=n(574);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(12).default)("371b0260",content,!0,{sourceMap:!1})},494:function(t,e,n){var content=n(576);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(12).default)("38b0c322",content,!0,{sourceMap:!1})},495:function(t,e,n){var content=n(578);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(12).default)("4e80dd4f",content,!0,{sourceMap:!1})},571:function(t,e,n){"use strict";var o=n(492);n.n(o).a},572:function(t,e,n){(e=n(11)(!1)).push([t.i,".detail-aside[data-v-bc1b4c46]{padding-left:25px}.detail-aside h4[data-v-bc1b4c46]{font-weight:400;font-size:18px;padding-bottom:10px;border-bottom:1px dashed #ddd}.detail-aside .recommend-item[data-v-bc1b4c46]{display:block;padding:20px 0;border-bottom:1px dashed green}.detail-aside .recommend-item h5[data-v-bc1b4c46]{padding-bottom:15px;font-size:17px;font-weight:400}.detail-aside .recommend-item p[data-v-bc1b4c46]{font-size:12px;color:#999}.detail-aside .recommend-item p span[data-v-bc1b4c46]{padding-left:15px;color:orange}",""]),t.exports=e},573:function(t,e,n){"use strict";var o=n(493);n.n(o).a},574:function(t,e,n){(e=n(11)(!1)).push([t.i,".cmt-list[data-v-09a6ba82]{border:1px solid #ddd;border-bottom:none}.cmt-list .cmt-item[data-v-09a6ba82]{border-bottom:1px dashed green;padding:20px 20px 5px}.cmt-list .cmt-item:hover strong[data-v-09a6ba82]{display:block!important;color:orange}.cmt-list[data-v-09a6ba82]:last-child{border-bottom:none}.cmt-info[data-v-09a6ba82]{margin-bottom:10px;font-size:12px;color:#666;vertical-align:top}.cmt-info img[data-v-09a6ba82]{width:16px;height:16px;border-radius:50%;vertical-align:top}.cmt-info i[data-v-09a6ba82]{color:#999}.cmt-info span[data-v-09a6ba82]{float:right}.cmt-content[data-v-09a6ba82]{padding:0 0 0 30px}.cmt-content .cmt-message[data-v-09a6ba82]{margin-top:10px}.cmt-content .cmt-pic[data-v-09a6ba82]{width:80px;height:80px;border-radius:6px;overflow:hidden;margin-right:5px;margin-top:10px;padding:5px;border:1px dashed #ddd}.cmt-content .cmt-pic img[data-v-09a6ba82]{display:block;width:100%;height:100%;-o-object-fit:cover;object-fit:cover;cursor:pointer}.cmt-content .cmt-ctrl[data-v-09a6ba82]{height:20px;line-height:20px;font-size:12px;color:#1e50a2;text-align:right}.cmt-content .cmt-ctrl strong[data-v-09a6ba82]{display:none;font-weight:400}.cmt-content .cmt-ctrl strong[data-v-09a6ba82]:hover{text-decoration:underline;cursor:pointer}",""]),t.exports=e},575:function(t,e,n){"use strict";var o=n(494);n.n(o).a},576:function(t,e,n){(e=n(11)(!1)).push([t.i,".cmt-empty[data-v-e4ea1be8]{color:#999;font-size:14px;text-align:center;padding:30px 0;border:1px dashed #ddd}.cmt-container[data-v-e4ea1be8]{margin-bottom:15px}",""]),t.exports=e},577:function(t,e,n){"use strict";var o=n(495);n.n(o).a},578:function(t,e,n){(e=n(11)(!1)).push([t.i,".post-detail[data-v-2954deb1]{width:1000px;min-width:1000px;margin:0 auto;padding-top:20px}.detail-content h1[data-v-2954deb1]{padding:20px 0 30px;border-bottom:1px dashed #ddd}.post-info[data-v-2954deb1]{color:#999;padding:20px;text-align:right}.post-info span[data-v-2954deb1]{margin-left:20px}.post-info span i[data-v-2954deb1]{color:orange}.detail-text[data-v-2954deb1] p{text-indent:1em;line-height:25px;padding:10px 0}.detail-text[data-v-2954deb1] p span{display:block;margin:10px 0}.detail-text[data-v-2954deb1] img{display:block;width:100%}.post-ctrl[data-v-2954deb1]{text-align:center;padding:35px;color:#666;cursor:pointer}.post-ctrl i[data-v-2954deb1]{display:block;font-size:28px;color:orange;padding-bottom:10px}.post-ctrl strong[data-v-2954deb1]{font-weight:400;color:orange}.cmt-wrappr[data-v-2954deb1],.cmt-wrappr h4[data-v-2954deb1]{margin-bottom:20px}.cmt-wrappr h4[data-v-2954deb1]{font-weight:400;font-size:18px}.comment-submit[data-v-2954deb1]{padding:10px 0 20px}.replyTag[data-v-2954deb1]{margin-bottom:10px}",""]),t.exports=e},590:function(t,e,n){"use strict";n.r(e);var o=n(59),r=n(335),c=n(334),l=n.n(c),d={data:function(){return{asideData:{}}},mounted:function(){var t=this,e=this.$route.query.id;this.$axios({url:"/posts/recommend",params:{id:e}}).then((function(e){var data=e.data;console.log(data),t.asideData=data.data}))},filters:{dateForm:function(time){return l()(new Date(time)).format("YYYY-MM-DD HH:MM")}}},m=(n(571),n(13)),h=Object(m.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"detail-aside"},[n("h4",[t._v("相关攻略")]),t._v(" "),n("div",{staticClass:"recommend-list"},t._l(t.asideData,(function(e,o){return n("nuxt-link",{key:o,staticClass:"recommend-item",attrs:{to:"/post/detail?id="+e.id}},[n("h5",[t._v(t._s(e.title))]),t._v(" "),n("p",[t._v(" "+t._s(t._f("dateForm")(e.created_at))),n("span",[t._v("阅读 - "+t._s(e.watch||Math.floor(100*Math.random())))])])])})),1)])}),[],!1,null,"bc1b4c46",null).exports,f={name:"CommentItem",props:["data"],filters:{dateForm:function(time){return l()(new Date(time)).format("YYYY-MM-DD HH:MM")}},computed:{dataMap:function(){return this.data.length?this.data:[this.data]}},methods:{replyUser:function(t,e){this.$emit("recUserId",{id:t,nickname:e})},recUserId:function(data){this.$emit("recUserId",data)}}},v=(n(573),{components:{DetailCommentItem:Object(m.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cmt-list"},t._l(t.dataMap,(function(e){return n("div",{key:e.id,staticClass:"cmt-item"},[n("div",{staticClass:"cmt-info"},[n("img",{attrs:{src:""+t.$axios.defaults.baseURL+(e.account&&e.account.defaultAvatar),alt:""}}),t._v(" "),n("i",[t._v(t._s(e.account.nickname))]),t._v(" "),n("i",[t._v(t._s(t._f("dateForm")(e.created_at)))]),t._v(" "),n("span",[t._v(t._s(e.level))])]),t._v(" "),e.parent?n("CommentItem",{attrs:{data:e.parent},on:{recUserId:t.recUserId}}):t._e(),t._v(" "),n("div",{staticClass:"cmt-content"},[n("div",{staticClass:"cmt-new"},[n("p",{staticClass:"cmt-message"},[t._v(t._s(e.content))]),t._v(" "),n("el-row",{attrs:{type:"flex"}},t._l(e.pics,(function(e){return n("div",{key:e.id,staticClass:"cmt-pic"},[n("img",{attrs:{src:""+t.$axios.defaults.baseURL+e.url,alt:""}})])})),0),t._v(" "),n("div",{staticClass:"cmt-ctrl"},[n("strong",{on:{click:function(n){return t.replyUser(e.id,e.account.nickname)}}},[t._v("回复")])])],1)])],1)})),0)}),[],!1,null,"09a6ba82",null).exports},props:{isUpdate:{type:Boolean}},data:function(){return{commentData:[],currentIndex:1,pageSize:5,total:""}},watch:{isUpdate:function(t,e){t&&(this.currentIndex=1,this.getCommentData(),this.$emit("closeUpdate",!1))}},mounted:function(){this.getCommentData()},methods:{getCommentData:function(){var t=this;this.$axios({url:"/posts/comments",params:{post:this.$route.query.id,_start:this.currentIndex-1,_limit:this.pageSize}}).then((function(e){var data=e.data;t.commentData=data.data,t.total=data.total,t.$emit("commentTotal",t.total)}))},handleSizeChange:function(data){this.pageSize=data,this.getCommentData()},handleCurrentChange:function(data){this.currentIndex=data,this.getCommentData()},recUserId:function(data){this.$emit("recUserId",data)}}}),j=(n(575),Object(m.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.commentData.length?n("div",[n("div",{staticClass:"cmt-container"},[n("DetailCommentItem",{attrs:{data:t.commentData},on:{recUserId:t.recUserId}})],1),t._v(" "),n("el-pagination",{attrs:{"current-page":t.currentIndex,"page-sizes":[5,10,15,20],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:+t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):n("div",{staticClass:"cmt-empty"},[t._v("\n  暂无评论，赶紧抢占沙发！\n")])}),[],!1,null,"e4ea1be8",null).exports),x=Object(o.a)({components:{DetailAside:h,DetailComment:j},data:function(){return{detailData:{city:{}},dialogImageUrl:"",dialogVisible:!1,textareaInput:"",isTagShow:!1,pics:[],follow:"",isUpdate:!1,fileList:[],nickname:"",total:""}},mounted:function(){this.detailDateRequest()},beforeRouteUpdate:function(t,e,n){this.detailDateRequest(),n()},methods:{detailDateRequest:function(){var t=this;this.$axios({url:"/posts",params:{id:this.$route.query.id}}).then((function(e){var data=e.data;t.detailData=data.data[0]}))},shareUser:function(){this.$message.warning("暂时不支持分享")},handleRemove:function(t,e){},handlePictureCardPreview:function(t){},fileUploadSuccess:function(t,e,n){this.pics=[].concat(Object(r.a)(this.pics),Object(r.a)(t))},closeTag:function(){this.isTagShow=!1,this.follow=null},closeUpdate:function(data){this.isUpdate=data},commentTotal:function(data){this.total=data},recUserId:function(data){console.log(data),this.isTagShow=!0,this.follow=data.id,this.nickname=data.nickname,this.$refs.detailText.focus();var t=this.$el.querySelector(".cmt-wrappr");this.$nextTick((function(){document.querySelector("html").scrollTop=t.offsetTop}))},submitComment:function(){var t=this;if(this.textareaInput||this.pics.length){var data={post:+this.$route.query.id,content:this.textareaInput,pics:this.pics};this.follow&&(data.follow=this.follow),this.$axios({url:"/comments",method:"POST",data:data,headers:{Authorization:"Bearer "+this.$store.state.user.userInfo.token}}).then((function(e){e.data;t.isTagShow=!1,t.isUpdate=!0,t.textareaInput="",t.pics=[],t.follow=null,t.fileList=[]}))}else this.$message.error("输入内容不能为空")}}},"beforeRouteUpdate",(function(t,e,n){n(),this.detailDateRequest(),this.isUpdate=!0})),_=(n(577),Object(m.a)(x,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post-detail"},[n("el-row",[n("el-col",{staticClass:"detail-content",attrs:{span:17}},[n("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[n("el-breadcrumb-item",{attrs:{to:{path:"/post"}}},[t._v("旅游攻略")]),t._v(" "),n("el-breadcrumb-item",[t._v("攻略详情")])],1),t._v(" "),n("h1",[t._v(t._s(t.detailData.title))]),t._v(" "),n("div",{staticClass:"post-info"},[n("span",[t._v("\n          攻略:\n          "),n("i",[t._v(t._s(t.detailData.city.created_at))])]),t._v(" "),n("span",[t._v("\n          阅读:\n          "),n("i",[t._v(t._s(t.detailData.watch||Math.floor(100*Math.random())))])])]),t._v(" "),n("div",{staticClass:"detail-text",domProps:{innerHTML:t._s(t.detailData.content)}}),t._v(" "),n("el-row",{staticClass:"post-ctrl"},[n("el-col",{staticClass:"post-crtl-item",attrs:{span:12}},[n("i",{staticClass:"iconfont iconpinglun"})]),t._v(" "),n("el-col",{staticClass:"post-crtl-item",attrs:{span:12}},[n("i",{staticClass:"iconfont iconfenxiang",on:{click:t.shareUser}})]),t._v(" "),n("el-col",{staticClass:"post-crtl-item",attrs:{span:12}},[t._v("\n          评论:(\n          "),n("strong",[t._v(t._s(t.total))]),t._v("\n          )\n        ")]),t._v(" "),n("el-col",{staticClass:"post-crtl-item",attrs:{span:12},on:{click:t.shareUser}},[t._v("分享")])],1),t._v(" "),n("div",{staticClass:"cmt-wrappr"},[n("h4",[t._v("评论")]),t._v(" "),t.isTagShow?n("el-tag",{staticClass:"replyTag",attrs:{type:"info",closable:""},on:{close:t.closeTag}},[t._v("回复：@"+t._s(t.nickname))]):t._e(),t._v(" "),n("el-input",{ref:"detailText",attrs:{type:"textarea",placeholder:"说点什么吧...",resize:"none"},model:{value:t.textareaInput,callback:function(e){t.textareaInput=e},expression:"textareaInput"}}),t._v(" "),n("el-row",{staticClass:"comment-submit"},[n("el-col",{attrs:{span:16}},[n("el-upload",{attrs:{action:""+t.$axios.defaults.baseURL,"list-type":"picture-card",name:"files","on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-success":t.fileUploadSuccess,"file-list":t.fileList}},[n("i",{staticClass:"el-icon-plus"})]),t._v(" "),n("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),t._v(" "),n("el-col",{staticStyle:{"text-align":"right"},attrs:{span:8}},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.submitComment}},[t._v("提交")])],1)],1),t._v(" "),n("DetailComment",{attrs:{isUpdate:t.isUpdate},on:{recUserId:t.recUserId,closeUpdate:t.closeUpdate,commentTotal:t.commentTotal}})],1)],1),t._v(" "),n("el-col",{attrs:{span:7}},[n("DetailAside")],1)],1)],1)}),[],!1,null,"2954deb1",null));e.default=_.exports}}]);